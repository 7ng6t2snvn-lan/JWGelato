<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#1a1a2e">
  <title>Gelato Formulator</title>
  <link rel="manifest" href="./manifest.json">
  <link rel="apple-touch-icon" href="./icon-192.png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    :root {
      --bg-primary: #1a1a2e;
      --bg-secondary: #16213e;
      --bg-card: #1f2a48;
      --bg-card-hover: #283555;
      --accent-pink: #e94560;
      --accent-gold: #f4a261;
      --accent-green: #2a9d8f;
      --accent-blue: #4cc9f0;
      --accent-red: #ef4444;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --text-muted: #64748b;
      --border-color: #2d3b4f;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    html { height: -webkit-fill-available; }
    #root { min-height: 100vh; min-height: -webkit-fill-available; }
    
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg-secondary); }
    ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
    
    .pin-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
      background: linear-gradient(135deg, var(--bg-primary) 0%, #0f0f1a 100%);
    }
    
    .pin-logo { font-size: 48px; margin-bottom: 16px; }
    .pin-title { font-size: 24px; font-weight: 700; margin-bottom: 8px; }
    .pin-subtitle { font-size: 13px; color: var(--text-secondary); margin-bottom: 32px; }
    
    .pin-dots { display: flex; gap: 16px; margin-bottom: 32px; }
    
    .pin-dot {
      width: 16px; height: 16px; border-radius: 50%;
      border: 2px solid var(--border-color);
      background: transparent; transition: all 0.2s;
    }
    
    .pin-dot.filled {
      background: var(--accent-pink);
      border-color: var(--accent-pink);
      box-shadow: 0 0 12px rgba(233, 69, 96, 0.4);
    }
    
    .pin-dot.error {
      background: var(--accent-red);
      border-color: var(--accent-red);
      animation: shake 0.4s ease-in-out;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-8px); }
      40%, 80% { transform: translateX(8px); }
    }
    
    .pin-keypad { display: grid; grid-template-columns: repeat(3, 72px); gap: 16px; }
    
    .pin-key {
      width: 72px; height: 72px; border-radius: 50%;
      border: 1px solid var(--border-color);
      background: var(--bg-card); color: var(--text-primary);
      font-size: 28px; font-weight: 500;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; transition: all 0.15s;
    }
    
    .pin-key:active {
      background: var(--accent-pink);
      border-color: var(--accent-pink);
      transform: scale(0.95);
    }
    
    .pin-key.empty { visibility: hidden; }
    .pin-key.delete { font-size: 20px; }
    
    .app-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--bg-primary);
    }
    
    .header {
      padding: 16px 20px;
      padding-top: max(16px, env(safe-area-inset-top));
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .header-title {
      font-size: 18px; font-weight: 700;
      display: flex; align-items: center; gap: 8px;
    }
    
    .header-title span { font-size: 20px; }
    
    .content {
      flex: 1;
      padding: 16px;
      padding-bottom: 100px;
      overflow-y: auto;
    }
    
    .nav {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-color);
      padding: 8px 12px;
      padding-bottom: max(8px, env(safe-area-inset-bottom));
      display: flex;
      justify-content: space-around;
    }
    
    .nav-item {
      display: flex; flex-direction: column;
      align-items: center; gap: 4px;
      padding: 8px 12px; border-radius: 12px;
      cursor: pointer; transition: all 0.2s;
      color: var(--text-muted);
      background: transparent; border: none;
      font-family: inherit;
    }
    
    .nav-item.active {
      color: var(--accent-pink);
      background: rgba(233, 69, 96, 0.1);
    }
    
    .nav-item svg { width: 22px; height: 22px; }
    .nav-item span { font-size: 10px; font-weight: 500; }
    
    .recipe-card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 12px;
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .recipe-card:hover { background: var(--bg-card-hover); }
    
    .recipe-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 8px;
    }
    
    .recipe-name { font-size: 16px; font-weight: 600; }
    
    .recipe-badge {
      font-size: 10px;
      padding: 4px 8px;
      border-radius: 6px;
      font-weight: 500;
    }
    
    .recipe-badge.gelato {
      background: rgba(233, 69, 96, 0.2);
      color: var(--accent-pink);
    }
    
    .recipe-badge.sorbet {
      background: rgba(76, 201, 240, 0.2);
      color: var(--accent-blue);
    }
    
    .recipe-meta {
      display: flex; gap: 16px;
      font-size: 12px; color: var(--text-secondary);
    }
    
    .recipe-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 8px;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid var(--border-color);
    }
    
    .stat-item { text-align: center; }
    .stat-value { font-size: 14px; font-weight: 600; font-family: 'JetBrains Mono', monospace; }
    .stat-label { font-size: 9px; color: var(--text-muted); text-transform: uppercase; }
    
    .stat-value.good { color: var(--accent-green); }
    .stat-value.warn { color: var(--accent-gold); }
    .stat-value.bad { color: var(--accent-red); }
    
    .btn {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      padding: 12px 20px; border-radius: 12px;
      font-size: 14px; font-weight: 600;
      cursor: pointer; transition: all 0.2s;
      border: none; font-family: inherit;
    }
    
    .btn-primary { background: var(--accent-pink); color: white; }
    .btn-primary:hover { background: #d63d56; }
    
    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
    
    .btn-danger { background: rgba(239, 68, 68, 0.2); color: var(--accent-red); }
    
    .modal-overlay {
      position: fixed; inset: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex; align-items: flex-end; justify-content: center;
      z-index: 100; padding: 20px;
    }
    
    .modal {
      background: var(--bg-secondary);
      border-radius: 24px 24px 0 0;
      width: 100%; max-width: 480px;
      max-height: 90vh; overflow-y: auto;
      padding: 24px;
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .modal-title { font-size: 18px; font-weight: 700; }
    
    .modal-close {
      width: 32px; height: 32px; border-radius: 50%;
      background: var(--bg-card); border: none;
      color: var(--text-secondary); cursor: pointer;
      display: flex; align-items: center; justify-content: center;
    }
    
    .form-group { margin-bottom: 16px; }
    .form-label { display: block; font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; font-weight: 500; }
    
    .form-input, .form-select {
      width: 100%; padding: 12px 16px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 14px; font-family: inherit;
    }
    
    .form-input:focus, .form-select:focus {
      outline: none;
      border-color: var(--accent-pink);
    }
    
    .search-container { margin-bottom: 16px; }
    
    .search-input {
      width: 100%; padding: 12px 16px; padding-left: 44px;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 14px; font-family: inherit;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748B'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'%3E%3C/path%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: 14px center;
      background-size: 20px;
    }
    
    .filter-tabs {
      display: flex; gap: 8px;
      margin-bottom: 16px;
      overflow-x: auto;
      padding-bottom: 8px;
    }
    
    .filter-tab {
      padding: 8px 14px;
      border-radius: 20px;
      font-size: 12px; font-weight: 500;
      white-space: nowrap;
      cursor: pointer; transition: all 0.2s;
      background: var(--bg-card);
      color: var(--text-secondary);
      border: 1px solid var(--border-color);
      font-family: inherit;
    }
    
    .filter-tab.active {
      background: var(--accent-pink);
      color: white;
      border-color: var(--accent-pink);
    }
    
    .ingredient-row {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 8px;
    }
    
    .ingredient-name { flex: 1; font-size: 14px; }
    .ingredient-amount { font-size: 14px; font-family: 'JetBrains Mono', monospace; color: var(--accent-gold); }
    
    .targets-section { margin-bottom: 24px; }
    .targets-title { font-size: 14px; font-weight: 600; margin-bottom: 12px; color: var(--accent-pink); }
    
    .target-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 8px;
    }
    
    .target-label { font-size: 13px; }
    .target-range { font-size: 13px; font-family: 'JetBrains Mono', monospace; color: var(--text-secondary); }
    
    .settings-section { margin-bottom: 24px; }
    .settings-title { font-size: 12px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; }
    
    .settings-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      background: var(--bg-card);
      border-radius: 12px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .settings-item:hover { background: var(--bg-card-hover); }
    .settings-item-label { font-size: 14px; }
    .settings-item-value { font-size: 13px; color: var(--text-secondary); font-family: 'JetBrains Mono', monospace; }
    
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }
    
    .empty-state-icon { font-size: 48px; margin-bottom: 16px; }
    .empty-state-text { font-size: 14px; line-height: 1.6; }
    
    .error-container {
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      min-height: 100vh; padding: 20px;
      text-align: center; background: var(--bg-primary);
    }
    
    .error-icon { font-size: 64px; margin-bottom: 20px; }
    .error-title { font-size: 20px; font-weight: 700; margin-bottom: 8px; color: var(--accent-red); }
    .error-message { font-size: 14px; color: var(--text-secondary); margin-bottom: 24px; max-width: 300px; }
    
    .scale-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 16px;
    }
    
    .scale-btn {
      width: 40px; height: 40px;
      border-radius: 50%;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .scale-value {
      font-size: 18px;
      font-weight: 600;
      font-family: 'JetBrains Mono', monospace;
      min-width: 100px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('SW registered'))
          .catch(err => console.log('SW failed:', err));
      });
    }
  </script>
  
  <script type="text/babel">
    const { useState, useEffect, useCallback, useMemo } = React;
    
    const APP_VERSION = '3.0.0';
    const BUILD_DATE = '2025-12-06';
    
    // Error Boundary
    class ErrorBoundary extends React.Component {
      constructor(props) {
        super(props);
        this.state = { hasError: false };
      }
      
      static getDerivedStateFromError(error) {
        return { hasError: true };
      }
      
      handleReset = () => window.location.reload();
      
      handleClearData = () => {
        if (confirm('Clear all data?')) {
          localStorage.clear();
          window.location.reload();
        }
      };
      
      render() {
        if (this.state.hasError) {
          return (
            <div className="error-container">
              <div className="error-icon">‚ö†Ô∏è</div>
              <div className="error-title">Something went wrong</div>
              <div className="error-message">Try refreshing or clearing data.</div>
              <button className="btn btn-primary" onClick={this.handleReset} style={{ marginBottom: 12 }}>Refresh</button>
              <button className="btn btn-danger" onClick={this.handleClearData}>Clear Data</button>
            </div>
          );
        }
        return this.props.children;
      }
    }
    
    // Icons
    const Icons = {
      Book: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M4 19.5A2.5 2.5 0 016.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/></svg>,
      Target: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>,
      Database: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>,
      Settings: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="12" cy="12" r="3"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>,
      Plus: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M12 5v14M5 12h14"/></svg>,
      Download: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/></svg>,
      Upload: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"/></svg>,
      Refresh: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>,
      Trash: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2"/></svg>,
      ChevronLeft: () => <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M15 18l-6-6 6-6"/></svg>,
    };
    
    // Ingredient Database
    const INGREDIENT_DATABASE = [
      // Dairy
      { id: 1, name: 'Milk 3.6%', fat: 3.6, sugar: 4.8, msnf: 8.9, fiber: 0, pac: 4.8, pod: 100, category: 'dairy' },
      { id: 2, name: 'Cream 40%', fat: 40, sugar: 2.8, msnf: 5.2, fiber: 0, pac: 2.8, pod: 100, category: 'dairy' },
      { id: 3, name: 'Cream 35%', fat: 35, sugar: 2.9, msnf: 5.5, fiber: 0, pac: 2.9, pod: 100, category: 'dairy' },
      { id: 4, name: 'SMP (Skim Milk Powder)', fat: 1, sugar: 52, msnf: 97, fiber: 0, pac: 52, pod: 100, category: 'dairy' },
      { id: 5, name: 'Buttermilk', fat: 0.9, sugar: 4.8, msnf: 9, fiber: 0, pac: 4.8, pod: 100, category: 'dairy' },
      
      // Sugars
      { id: 10, name: 'Sucrose', fat: 0, sugar: 100, msnf: 0, fiber: 0, pac: 100, pod: 100, category: 'sugar' },
      { id: 11, name: 'Dextrose', fat: 0, sugar: 100, msnf: 0, fiber: 0, pac: 180, pod: 70, category: 'sugar' },
      { id: 12, name: 'Glucose Syrup 42DE', fat: 0, sugar: 80, msnf: 0, fiber: 0, pac: 80, pod: 40, category: 'sugar' },
      { id: 13, name: 'Trimoline (Invert Sugar)', fat: 0, sugar: 100, msnf: 0, fiber: 0, pac: 130, pod: 130, category: 'sugar' },
      { id: 14, name: 'Inulin', fat: 0, sugar: 0, msnf: 0, fiber: 90, pac: 10, pod: 0, category: 'sugar' },
      { id: 15, name: 'Maltodextrin', fat: 0, sugar: 95, msnf: 0, fiber: 0, pac: 5, pod: 5, category: 'sugar' },
      
      // Stabilizers
      { id: 20, name: 'Tara Gum', fat: 0, sugar: 0, msnf: 0, fiber: 80, pac: 0, pod: 0, category: 'stabilizer' },
      { id: 21, name: 'Perfect Gelato Stabilizer', fat: 0, sugar: 32, msnf: 0, fiber: 57, pac: 177, pod: 74, category: 'stabilizer' },
      
      // Water
      { id: 25, name: 'Water', fat: 0, sugar: 0, msnf: 0, fiber: 0, pac: 0, pod: 0, category: 'other' },
      
      // Chocolate & Cacao
      { id: 30, name: 'Cacao 22-24%', fat: 23, sugar: 0, msnf: 0, fiber: 33, pac: 0, pod: 0, category: 'chocolate' },
      { id: 31, name: 'Callebaut 70.5% Chocolate', fat: 41, sugar: 28, msnf: 0, fiber: 11, pac: 28, pod: 28, category: 'chocolate' },
      { id: 32, name: 'Chocolate 66% BTSW', fat: 40, sugar: 30, msnf: 0, fiber: 10, pac: 30, pod: 30, category: 'chocolate' },
      
      // Fats & Oils
      { id: 40, name: 'Coconut Oil', fat: 100, sugar: 0, msnf: 0, fiber: 0, pac: 0, pod: 0, category: 'fats' },
      { id: 41, name: 'Extra Virgin Olive Oil', fat: 100, sugar: 0, msnf: 0, fiber: 0, pac: 0, pod: 0, category: 'fats' },
      
      // Fruit Purees
      { id: 50, name: 'Boiron Coconut', fat: 24, sugar: 3, msnf: 0, fiber: 2, pac: 3, pod: 3, category: 'fruit-tropical' },
      { id: 51, name: 'Boiron Blueberry', fat: 0.3, sugar: 10, msnf: 0, fiber: 2.4, pac: 10, pod: 10, category: 'fruit-berry' },
      { id: 52, name: 'Strawberry Pur√©e', fat: 0.3, sugar: 5, msnf: 0, fiber: 2, pac: 5, pod: 5, category: 'fruit-berry' },
      { id: 53, name: 'Passion Fruit Pur√©e', fat: 0.7, sugar: 11, msnf: 0, fiber: 10, pac: 11, pod: 11, category: 'fruit-tropical' },
      { id: 54, name: 'Rhubarb Strawberry Pur√©e', fat: 0.2, sugar: 4, msnf: 0, fiber: 2, pac: 4, pod: 4, category: 'fruit-berry' },
      
      // Citrus
      { id: 60, name: 'Lemon Juice', fat: 0, sugar: 2.5, msnf: 0, fiber: 0.3, pac: 2.5, pod: 2.5, category: 'fruit-citrus' },
      
      // Salt
      { id: 65, name: 'Sea Salt Flakes', fat: 0, sugar: 0, msnf: 0, fiber: 0, pac: 0, pod: 0, category: 'other' },
      
      // Prepared
      { id: 70, name: 'Salted Caramel for Gelato', fat: 25.41, sugar: 43.69, msnf: 1.56, fiber: 0, pac: 48.73, pod: 43.18, category: 'prepared' },
    ];
    
    // Default Recipes - All 4kg batches with Tara Gum 13.5g
    const DEFAULT_RECIPES = [
      {
        id: 1,
        name: 'Chocolate Sorbet',
        type: 'sorbet',
        batchSize: 4000,
        items: [
          { ingredientId: 25, amount: 2600 },  // Water
          { ingredientId: 10, amount: 800 },   // Sucrose
          { ingredientId: 11, amount: 240 },   // Dextrose
          { ingredientId: 15, amount: 100 },   // Maltodextrin
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 30, amount: 240 },   // Cacao 22-24%
        ]
      },
      {
        id: 2,
        name: 'Buttermilk Gelato',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 1, amount: 1431 },   // Milk 3.6%
          { ingredientId: 3, amount: 858 },    // Cream 35%
          { ingredientId: 5, amount: 716 },    // Buttermilk
          { ingredientId: 10, amount: 626 },   // Sucrose
          { ingredientId: 11, amount: 179 },   // Dextrose
          { ingredientId: 12, amount: 89.5 },  // Glucose Syrup 42DE
          { ingredientId: 4, amount: 89.5 },   // SMP
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
        ]
      },
      {
        id: 3,
        name: 'Chocolate Gelato w/ Callebaut 70.5%',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 1, amount: 2405 },   // Milk 3.6%
          { ingredientId: 12, amount: 185 },   // Glucose Syrup 42DE
          { ingredientId: 11, amount: 148 },   // Dextrose
          { ingredientId: 4, amount: 111 },    // SMP
          { ingredientId: 30, amount: 67 },    // Cacao 22-24%
          { ingredientId: 10, amount: 259 },   // Sucrose
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 31, amount: 740 },   // Callebaut 70.5%
          { ingredientId: 13, amount: 74 },    // Trimoline
        ]
      },
      {
        id: 4,
        name: 'Blueberry-Coconut Sorbet',
        type: 'sorbet',
        batchSize: 4000,
        items: [
          { ingredientId: 50, amount: 998 },   // Boiron Coconut
          { ingredientId: 51, amount: 1996 },  // Boiron Blueberry
          { ingredientId: 10, amount: 499 },   // Sucrose
          { ingredientId: 12, amount: 200 },   // Glucose Syrup 42DE
          { ingredientId: 11, amount: 200 },   // Dextrose
          { ingredientId: 25, amount: 100 },   // Water
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
        ]
      },
      {
        id: 5,
        name: 'Strawberry Gelato',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 52, amount: 1186 },  // Strawberry Pur√©e
          { ingredientId: 1, amount: 822 },    // Milk 3.6%
          { ingredientId: 2, amount: 889 },    // Cream 40%
          { ingredientId: 10, amount: 267 },   // Sucrose
          { ingredientId: 11, amount: 283 },   // Dextrose
          { ingredientId: 12, amount: 118 },   // Glucose Syrup 42DE
          { ingredientId: 4, amount: 89 },     // SMP
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 25, amount: 334 },   // Water
        ]
      },
      {
        id: 6,
        name: 'Passion Fruit Sorbet',
        type: 'sorbet',
        batchSize: 4000,
        items: [
          { ingredientId: 53, amount: 1200 },  // Passion Fruit
          { ingredientId: 60, amount: 40 },    // Lemon
          { ingredientId: 10, amount: 720 },   // Sucrose
          { ingredientId: 11, amount: 120 },   // Dextrose
          { ingredientId: 12, amount: 160 },   // Glucose Syrup 42DE
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 25, amount: 1420 },  // Water
          { ingredientId: 14, amount: 320 },   // Inulin
        ]
      },
      {
        id: 7,
        name: 'Coconut-Vanilla Gelato',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 2, amount: 68 },     // Cream 40%
          { ingredientId: 1, amount: 1689 },   // Milk 3.6%
          { ingredientId: 50, amount: 1351 },  // Boiron Coconut
          { ingredientId: 10, amount: 676 },   // Sucrose
          { ingredientId: 11, amount: 68 },    // Dextrose
          { ingredientId: 12, amount: 68 },    // Glucose Syrup 42DE
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 40, amount: 68 },    // Coconut Oil
        ]
      },
      {
        id: 8,
        name: 'Salted Caramel Gelato',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 10, amount: 499.5 },  // Caster/White Sugar (A) - for caramel
          { ingredientId: 65, amount: 16 },     // Sea Salt Flakes
          { ingredientId: 10, amount: 79.9 },   // Caster/White Sugar (B)
          { ingredientId: 20, amount: 13.5 },   // Tara Gum
          { ingredientId: 1, amount: 2597.4 },  // Whole Milk
          { ingredientId: 2, amount: 479.5 },   // Cream 40%
          { ingredientId: 4, amount: 179.8 },   // Skimmed Milk Powder
          { ingredientId: 12, amount: 105 },    // Dry Glucose Powder (42DE)
          { ingredientId: 14, amount: 80 },     // Inulin
        ]
      },
      {
        id: 9,
        name: 'Fior di Latte',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 1, amount: 2220 },   // Milk 3.6%
          { ingredientId: 2, amount: 800 },    // Cream 40%
          { ingredientId: 10, amount: 560 },   // Sucrose
          { ingredientId: 12, amount: 140 },   // Glucose Syrup 42DE
          { ingredientId: 11, amount: 80 },    // Dextrose
          { ingredientId: 4, amount: 180 },    // SMP
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
        ]
      },
      {
        id: 10,
        name: 'Lemon Olive Oil Gelato',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 1, amount: 1553 },   // Milk 3.6%
          { ingredientId: 2, amount: 388 },    // Cream 40%
          { ingredientId: 4, amount: 175 },    // SMP
          { ingredientId: 10, amount: 544 },   // Sucrose
          { ingredientId: 12, amount: 291 },   // Glucose Syrup 42DE
          { ingredientId: 11, amount: 194 },   // Dextrose
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 41, amount: 155 },   // EVOO
          { ingredientId: 25, amount: 680 },   // Water
        ]
      },
      {
        id: 11,
        name: 'Chocolate Gelato Test 2',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 1, amount: 2600 },   // Milk 3.6%
          { ingredientId: 12, amount: 200 },   // Glucose Syrup 42DE
          { ingredientId: 11, amount: 160 },   // Dextrose
          { ingredientId: 4, amount: 120 },    // SMP
          { ingredientId: 30, amount: 72 },    // Cacao 22-24%
          { ingredientId: 10, amount: 200 },   // Sucrose
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 32, amount: 600 },   // Chocolate 66%
          { ingredientId: 13, amount: 40 },    // Trimoline
        ]
      },
      {
        id: 12,
        name: 'Rhubarb Strawberry Gelato',
        type: 'gelato',
        batchSize: 4000,
        items: [
          { ingredientId: 54, amount: 1154 },  // Rhubarb Strawberry Pur√©e
          { ingredientId: 1, amount: 865 },    // Milk 3.6%
          { ingredientId: 2, amount: 865 },    // Cream 40%
          { ingredientId: 10, amount: 260 },   // Sucrose
          { ingredientId: 11, amount: 360 },   // Dextrose
          { ingredientId: 12, amount: 115 },   // Glucose Syrup 42DE
          { ingredientId: 4, amount: 87 },     // SMP
          { ingredientId: 20, amount: 13.5 },  // Tara Gum
          { ingredientId: 25, amount: 288 },   // Water
        ]
      },
    ];
    
    // Target ranges
    const GELATO_TARGETS = {
      fat: { min: 6, max: 10, ideal: 8, label: 'Fat %' },
      sugar: { min: 18, max: 22, ideal: 20, label: 'Sugar %' },
      msnf: { min: 7, max: 11, ideal: 9, label: 'MSNF %' },
      totalSolids: { min: 35, max: 42, ideal: 38, label: 'Total Solids %' },
    };
    
    const SORBET_TARGETS = {
      fat: { min: 0, max: 3, ideal: 0, label: 'Fat %' },
      sugar: { min: 26, max: 32, ideal: 29, label: 'Sugar %' },
      totalSolids: { min: 28, max: 35, ideal: 31, label: 'Total Solids %' },
    };
    
    // Main App
    function App() {
      const [isAuthenticated, setIsAuthenticated] = useState(false);
      const [pin, setPin] = useState('');
      const [pinError, setPinError] = useState(false);
      const [activeTab, setActiveTab] = useState('recipes');
      const [recipes, setRecipes] = useState([]);
      const [search, setSearch] = useState('');
      const [typeFilter, setTypeFilter] = useState('all');
      const [selectedRecipe, setSelectedRecipe] = useState(null);
      const [scaleMultiplier, setScaleMultiplier] = useState(1);
      const [dataLoaded, setDataLoaded] = useState(false);
      
      const CORRECT_PIN = '0119';
      
      // Load data
      useEffect(() => {
        try {
          const saved = localStorage.getItem('gelato-recipes');
          const savedAuth = sessionStorage.getItem('gelato-auth');
          
          if (saved) {
            setRecipes(JSON.parse(saved));
          } else {
            setRecipes(DEFAULT_RECIPES);
          }
          
          if (savedAuth === 'true') setIsAuthenticated(true);
          setDataLoaded(true);
        } catch (e) {
          setRecipes(DEFAULT_RECIPES);
          setDataLoaded(true);
        }
      }, []);
      
      // Save data
      useEffect(() => {
        if (dataLoaded && recipes.length > 0) {
          localStorage.setItem('gelato-recipes', JSON.stringify(recipes));
        }
      }, [recipes, dataLoaded]);
      
      // PIN handling
      const handlePinInput = (digit) => {
        if (pin.length < 4) {
          const newPin = pin + digit;
          setPin(newPin);
          setPinError(false);
          
          if (newPin.length === 4) {
            if (newPin === CORRECT_PIN) {
              setTimeout(() => {
                setIsAuthenticated(true);
                sessionStorage.setItem('gelato-auth', 'true');
              }, 200);
            } else {
              setPinError(true);
              setTimeout(() => { setPin(''); setPinError(false); }, 600);
            }
          }
        }
      };
      
      const handlePinDelete = () => { setPin(pin.slice(0, -1)); setPinError(false); };
      
      // Calculate recipe stats
      const calculateStats = useCallback((recipe, multiplier = 1) => {
        let totalWeight = 0;
        let totalFat = 0;
        let totalSugar = 0;
        let totalMsnf = 0;
        let totalFiber = 0;
        let totalSolids = 0;
        
        recipe.items.forEach(item => {
          const ingredient = INGREDIENT_DATABASE.find(i => i.id === item.ingredientId);
          if (!ingredient) return;
          
          const amount = item.amount * multiplier;
          totalWeight += amount;
          
          const fatG = (ingredient.fat / 100) * amount;
          const sugarG = (ingredient.sugar / 100) * amount;
          const msnfG = (ingredient.msnf / 100) * amount;
          const fiberG = (ingredient.fiber / 100) * amount;
          
          totalFat += fatG;
          totalSugar += sugarG;
          totalMsnf += msnfG;
          totalFiber += fiberG;
          totalSolids += fatG + sugarG + msnfG + fiberG;
        });
        
        return {
          weight: totalWeight,
          fat: totalWeight > 0 ? (totalFat / totalWeight) * 100 : 0,
          sugar: totalWeight > 0 ? (totalSugar / totalWeight) * 100 : 0,
          msnf: totalWeight > 0 ? (totalMsnf / totalWeight) * 100 : 0,
          fiber: totalWeight > 0 ? (totalFiber / totalWeight) * 100 : 0,
          totalSolids: totalWeight > 0 ? (totalSolids / totalWeight) * 100 : 0,
        };
      }, []);
      
      // Get status class for stat
      const getStatClass = (value, target) => {
        if (value >= target.min && value <= target.max) return 'good';
        if (Math.abs(value - target.ideal) <= 3) return 'warn';
        return 'bad';
      };
      
      // Filter recipes
      const filteredRecipes = useMemo(() => {
        return recipes.filter(r => {
          const matchesSearch = r.name.toLowerCase().includes(search.toLowerCase());
          const matchesType = typeFilter === 'all' || r.type === typeFilter;
          return matchesSearch && matchesType;
        });
      }, [recipes, search, typeFilter]);
      
      // Export
      const exportData = () => {
        const data = { version: APP_VERSION, recipes };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `gelato-backup-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
      };
      
      // Import
      const importData = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (evt) => {
            try {
              const data = JSON.parse(evt.target.result);
              if (data.recipes) setRecipes(data.recipes);
              alert('Imported successfully!');
            } catch { alert('Error importing'); }
          };
          reader.readAsText(file);
        }
      };
      
      // Force refresh
      const forceRefresh = () => {
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.getRegistrations().then(regs => {
            regs.forEach(r => r.unregister());
          });
        }
        caches.keys().then(names => { names.forEach(n => caches.delete(n)); });
        window.location.reload(true);
      };
      
      // Clear data
      const clearData = () => {
        if (confirm('Clear all data and restore defaults?')) {
          localStorage.removeItem('gelato-recipes');
          setRecipes(DEFAULT_RECIPES);
        }
      };
      
      // PIN Screen
      if (!isAuthenticated) {
        return (
          <div className="pin-container">
            <div className="pin-logo">üç®</div>
            <div className="pin-title">Gelato Formulator</div>
            <div className="pin-subtitle">Enter PIN to continue</div>
            <div className="pin-dots">
              {[0,1,2,3].map(i => (
                <div key={i} className={`pin-dot ${pin.length > i ? 'filled' : ''} ${pinError ? 'error' : ''}`} />
              ))}
            </div>
            <div className="pin-keypad">
              {[1,2,3,4,5,6,7,8,9,'',0,'‚å´'].map((k, i) => (
                <button key={i} className={`pin-key ${k === '' ? 'empty' : ''} ${k === '‚å´' ? 'delete' : ''}`}
                  onClick={() => k === '‚å´' ? handlePinDelete() : k !== '' && handlePinInput(String(k))}>
                  {k}
                </button>
              ))}
            </div>
          </div>
        );
      }
      
      // Recipe Detail View
      if (selectedRecipe) {
        const stats = calculateStats(selectedRecipe, scaleMultiplier);
        const targets = selectedRecipe.type === 'gelato' ? GELATO_TARGETS : SORBET_TARGETS;
        
        return (
          <div className="app-container">
            <header className="header">
              <button onClick={() => { setSelectedRecipe(null); setScaleMultiplier(1); }} style={{ background: 'none', border: 'none', color: 'var(--text-primary)', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: 8 }}>
                <Icons.ChevronLeft /> Back
              </button>
              <span className={`recipe-badge ${selectedRecipe.type}`}>{selectedRecipe.type}</span>
            </header>
            
            <main className="content">
              <h1 style={{ fontSize: 20, fontWeight: 700, marginBottom: 8 }}>{selectedRecipe.name}</h1>
              
              <div className="scale-controls">
                <button className="scale-btn" onClick={() => setScaleMultiplier(Math.max(0.5, scaleMultiplier - 0.5))}>‚àí</button>
                <div className="scale-value">{(selectedRecipe.batchSize * scaleMultiplier / 1000).toFixed(1)} kg</div>
                <button className="scale-btn" onClick={() => setScaleMultiplier(scaleMultiplier + 0.5)}>+</button>
              </div>
              
              <div className="recipe-stats" style={{ marginBottom: 20 }}>
                <div className="stat-item">
                  <div className={`stat-value ${getStatClass(stats.fat, targets.fat)}`}>{stats.fat.toFixed(1)}%</div>
                  <div className="stat-label">Fat</div>
                </div>
                <div className="stat-item">
                  <div className={`stat-value ${getStatClass(stats.sugar, targets.sugar)}`}>{stats.sugar.toFixed(1)}%</div>
                  <div className="stat-label">Sugar</div>
                </div>
                {selectedRecipe.type === 'gelato' && (
                  <div className="stat-item">
                    <div className={`stat-value ${getStatClass(stats.msnf, targets.msnf)}`}>{stats.msnf.toFixed(1)}%</div>
                    <div className="stat-label">MSNF</div>
                  </div>
                )}
                <div className="stat-item">
                  <div className={`stat-value ${getStatClass(stats.totalSolids, targets.totalSolids)}`}>{stats.totalSolids.toFixed(1)}%</div>
                  <div className="stat-label">Solids</div>
                </div>
              </div>
              
              <h3 style={{ fontSize: 14, fontWeight: 600, marginBottom: 12, color: 'var(--accent-pink)' }}>Ingredients</h3>
              
              {selectedRecipe.items.map((item, idx) => {
                const ingredient = INGREDIENT_DATABASE.find(i => i.id === item.ingredientId);
                return (
                  <div key={idx} className="ingredient-row">
                    <span className="ingredient-name">{ingredient?.name || 'Unknown'}</span>
                    <span className="ingredient-amount">{(item.amount * scaleMultiplier).toFixed(1)}g</span>
                  </div>
                );
              })}
              
              <div style={{ marginTop: 20, padding: 16, background: 'var(--bg-card)', borderRadius: 12 }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 8 }}>
                  <span style={{ color: 'var(--text-secondary)', fontSize: 13 }}>Total Weight</span>
                  <span style={{ fontFamily: 'JetBrains Mono', fontWeight: 600 }}>{stats.weight.toFixed(0)}g</span>
                </div>
                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                  <span style={{ color: 'var(--text-secondary)', fontSize: 13 }}>Fiber</span>
                  <span style={{ fontFamily: 'JetBrains Mono' }}>{stats.fiber.toFixed(1)}%</span>
                </div>
              </div>
            </main>
          </div>
        );
      }
      
      return (
        <div className="app-container">
          <header className="header">
            <div className="header-title"><span>üç®</span> Gelato Formulator</div>
            <div style={{ fontSize: 10, color: 'var(--text-muted)', fontFamily: 'JetBrains Mono' }}>v{APP_VERSION}</div>
          </header>
          
          <main className="content">
            {/* Recipes Tab */}
            {activeTab === 'recipes' && (
              <>
                <div className="search-container">
                  <input type="text" className="search-input" placeholder="Search recipes..." value={search} onChange={e => setSearch(e.target.value)} />
                </div>
                
                <div className="filter-tabs">
                  {['all', 'gelato', 'sorbet'].map(t => (
                    <button key={t} className={`filter-tab ${typeFilter === t ? 'active' : ''}`} onClick={() => setTypeFilter(t)}>
                      {t === 'all' ? 'All' : t.charAt(0).toUpperCase() + t.slice(1)}
                    </button>
                  ))}
                </div>
                
                {filteredRecipes.length === 0 ? (
                  <div className="empty-state">
                    <div className="empty-state-icon">üìã</div>
                    <div className="empty-state-text">No recipes found</div>
                  </div>
                ) : (
                  filteredRecipes.map(recipe => {
                    const stats = calculateStats(recipe);
                    const targets = recipe.type === 'gelato' ? GELATO_TARGETS : SORBET_TARGETS;
                    return (
                      <div key={recipe.id} className="recipe-card" onClick={() => setSelectedRecipe(recipe)}>
                        <div className="recipe-header">
                          <div className="recipe-name">{recipe.name}</div>
                          <span className={`recipe-badge ${recipe.type}`}>{recipe.type}</span>
                        </div>
                        <div className="recipe-meta">
                          <span>{recipe.items.length} ingredients</span>
                          <span>{(recipe.batchSize / 1000).toFixed(1)} kg</span>
                        </div>
                        <div className="recipe-stats">
                          <div className="stat-item">
                            <div className={`stat-value ${getStatClass(stats.fat, targets.fat)}`}>{stats.fat.toFixed(1)}%</div>
                            <div className="stat-label">Fat</div>
                          </div>
                          <div className="stat-item">
                            <div className={`stat-value ${getStatClass(stats.sugar, targets.sugar)}`}>{stats.sugar.toFixed(1)}%</div>
                            <div className="stat-label">Sugar</div>
                          </div>
                          <div className="stat-item">
                            <div className="stat-value">{stats.msnf.toFixed(1)}%</div>
                            <div className="stat-label">MSNF</div>
                          </div>
                          <div className="stat-item">
                            <div className={`stat-value ${getStatClass(stats.totalSolids, targets.totalSolids)}`}>{stats.totalSolids.toFixed(1)}%</div>
                            <div className="stat-label">Solids</div>
                          </div>
                        </div>
                      </div>
                    );
                  })
                )}
              </>
            )}
            
            {/* Targets Tab */}
            {activeTab === 'targets' && (
              <>
                <div className="targets-section">
                  <div className="targets-title">üç® Gelato Targets</div>
                  {Object.entries(GELATO_TARGETS).map(([key, t]) => (
                    <div key={key} className="target-row">
                      <span className="target-label">{t.label}</span>
                      <span className="target-range">{t.min}% ‚Äì {t.max}% (ideal: {t.ideal}%)</span>
                    </div>
                  ))}
                </div>
                
                <div className="targets-section">
                  <div className="targets-title">üçß Sorbet Targets</div>
                  {Object.entries(SORBET_TARGETS).map(([key, t]) => (
                    <div key={key} className="target-row">
                      <span className="target-label">{t.label}</span>
                      <span className="target-range">{t.min}% ‚Äì {t.max}% (ideal: {t.ideal}%)</span>
                    </div>
                  ))}
                </div>
              </>
            )}
            
            {/* Ingredients Tab */}
            {activeTab === 'ingredients' && (
              <>
                <div className="search-container">
                  <input type="text" className="search-input" placeholder="Search ingredients..." value={search} onChange={e => setSearch(e.target.value)} />
                </div>
                
                {INGREDIENT_DATABASE.filter(i => i.name.toLowerCase().includes(search.toLowerCase())).map(ing => (
                  <div key={ing.id} className="ingredient-row" style={{ flexDirection: 'column', alignItems: 'flex-start', gap: 8 }}>
                    <div style={{ fontWeight: 600, fontSize: 14 }}>{ing.name}</div>
                    <div style={{ display: 'flex', gap: 16, fontSize: 11, color: 'var(--text-secondary)' }}>
                      <span>Fat: {ing.fat}%</span>
                      <span>Sugar: {ing.sugar}%</span>
                      <span>MSNF: {ing.msnf}%</span>
                      <span>Fiber: {ing.fiber}%</span>
                    </div>
                  </div>
                ))}
              </>
            )}
            
            {/* Settings Tab */}
            {activeTab === 'settings' && (
              <>
                <div className="settings-section">
                  <h3 className="settings-title">Data Management</h3>
                  <div className="settings-item" onClick={exportData}>
                    <span className="settings-item-label">Export Data</span>
                    <Icons.Download />
                  </div>
                  <label className="settings-item">
                    <span className="settings-item-label">Import Data</span>
                    <input type="file" accept=".json" onChange={importData} style={{ display: 'none' }} />
                    <Icons.Upload />
                  </label>
                  <div className="settings-item" onClick={forceRefresh}>
                    <span className="settings-item-label">Force Refresh App</span>
                    <Icons.Refresh />
                  </div>
                  <div className="settings-item" onClick={clearData}>
                    <span className="settings-item-label" style={{ color: 'var(--accent-red)' }}>Reset to Defaults</span>
                    <Icons.Trash />
                  </div>
                </div>
                
                <div className="settings-section">
                  <h3 className="settings-title">App Info</h3>
                  <div className="settings-item">
                    <span className="settings-item-label">Version</span>
                    <span className="settings-item-value">{APP_VERSION}</span>
                  </div>
                  <div className="settings-item">
                    <span className="settings-item-label">Recipes</span>
                    <span className="settings-item-value">{recipes.length}</span>
                  </div>
                  <div className="settings-item">
                    <span className="settings-item-label">Ingredients</span>
                    <span className="settings-item-value">{INGREDIENT_DATABASE.length}</span>
                  </div>
                </div>
              </>
            )}
          </main>
          
          <nav className="nav">
            <button className={`nav-item ${activeTab === 'recipes' ? 'active' : ''}`} onClick={() => setActiveTab('recipes')}>
              <Icons.Book />
              <span>Recipes</span>
            </button>
            <button className={`nav-item ${activeTab === 'targets' ? 'active' : ''}`} onClick={() => setActiveTab('targets')}>
              <Icons.Target />
              <span>Targets</span>
            </button>
            <button className={`nav-item ${activeTab === 'ingredients' ? 'active' : ''}`} onClick={() => setActiveTab('ingredients')}>
              <Icons.Database />
              <span>Ingredients</span>
            </button>
            <button className={`nav-item ${activeTab === 'settings' ? 'active' : ''}`} onClick={() => setActiveTab('settings')}>
              <Icons.Settings />
              <span>Settings</span>
            </button>
          </nav>
        </div>
      );
    }
    
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<ErrorBoundary><App /></ErrorBoundary>);
  </script>
</body>
</html>
